---
title: "Resolución Problemas"
output:
  pdf_document:
    toc: true
    number_sections: true
    toc_depth: 5
lang: es
number-sections: true
toc: true
---
\newpage


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source("teoriadecision_funciones_incertidumbre.R")
```

# Laura Mayorgasdel Castillo

## Problema 1 
Aplicar los criterios de decisión bajo incertidumbre a los problemas cuya matriz de valores numéricos vienen dadas en la tabla siguiente: 

```{r, echo=FALSE}
tabla=cbind(tabla <- data.frame(
  e1 = c(4,5,-3,7,8),
  e2 = c(3,-1,3,7,9),
  e3 = c(-4,9,8,2,1),
  e4 = c(4,6,7,-9,3)
))
row.names(tabla)=c("d1","d2","d3","d4","d5")
knitr::kable(tabla)
```


a) Desde el punto de vista FAVORABLE
b) Desde el punto de vista DESFAVORABLE

###  Desde el punto de vista FAVORABLE o BENEFICIOS
```{r}
tb01= crea.tablaX(c(4,5,-3,7,8,
                    3,-1,3,7,9,
                    -4,9,8,2,1,
                    4,6,7,-9,3),numalternativas = 4,numestados = 5)
```

1. Criterio de Wald

```{r}
sol1Wlad=criterio.Wald(tb01,favorable = TRUE)
cat("La solución por el criterio de Wald es la:", sol1Wlad$AlternativaOptima)
```

2. Criterio optimista

```{r}
sol1Opt=criterio.Optimista(tb01,favorable = TRUE)
cat("La solución por el criterio Optimista es la:", sol1Opt$AlternativaOptima)
```

3. Criterio de Hurwitcz
```{r}
sol1Hur=criterio.Hurwicz(tb01,favorable = TRUE)
cat("La solución por el criterio de Hurwitcz es la:", sol1Hur$AlternativaOptima)
```

```{r,fig.dim=0.4}
dibuja.criterio.Hurwicz(tb01,favorable = TRUE)
```


4. Criterio de Savage
```{r}
sol1Sav=criterio.Savage(tb01,favorable = TRUE)
cat("La solución por el criterio de Savage es la:", sol1Sav$AlternativaOptima)
```


5. Criterio de Lapalce

```{r}
sol1Lap=criterio.Laplace(tb01,favorable = TRUE)
cat("La solución por el criterio Laplace es la:", sol1Lap$AlternativaOptima)
```


7. Criterio del punto ideal

```{r}
sol1PuntId=criterio.PuntoIdeal(tb01,favorable = TRUE)
cat("La solución por el criterio del Punto Ideal es la:", sol1PuntId$AlternativaOptima)

```

8. Criterios todos

```{r}
sol1Todos=criterio.Todos(tb01,favorable = T, alfa = 0.5)
knitr::kable(sol1Todos[,6:ncol(sol1Todos)])
```


###  Desde el punto de vista DESFAVORABLE o de COSTES

1. Criterio de Wald

```{r}
sol2Wlad=criterio.Wald(tb01,favorable = FALSE)
cat("La solución por el criterio de Wald es la:", sol2Wlad$AlternativaOptima)
```

2. Criterio optimista

```{r}
sol2Opt=criterio.Optimista(tb01,favorable = FALSE)
cat("La solución por el criterio Optimista es la:", sol2Opt$AlternativaOptima)
```


\newpage
3. Criterio de Hurwitcz
```{r}
sol2Hur1=criterio.Hurwicz(tb01,favorable = FALSE,alfa = 0.4)
cat("La solución por el criterio de Hurwitcz es la:", sol2Hur1$AlternativaOptima)
```

```{r}
sol2Hur2= criterio.Hurwicz.General(tb01,favorable = FALSE, alfa = 0.4)
dibuja.criterio.Hurwicz(tb01,favorable = FALSE)
```


4. Criterio de Savage
```{r}
sol2Sav=criterio.Savage(tb01,favorable = FALSE)
cat("La solución por el criterio de Savage es la:", sol2Sav$AlternativaOptima)
```


5. Criterio de Lapalce

```{r}
sol2Lap=criterio.Laplace(tb01,favorable = FALSE)
cat("La solución por el criterio Laplace es la:", sol2Lap$AlternativaOptima)
```


6. Criterio del punto ideal

```{r}
sol2PuntId=criterio.PuntoIdeal(tb01,favorable = FALSE)
cat("La solución por el criterio del Punto Ideal es la:", sol2PuntId$AlternativaOptima)

```

7. Criterios todos

```{r}
sol2Todos=criterio.Todos(tb01,favorable = FALSE, alfa = 0.5)
knitr::kable(sol2Todos[,6:ncol(sol2Todos)])
```

\newpage

## Problema 2

El equipo ARUS de Formula Student de la Universidad de Sevilla está evaluando a qué competición asistir este año. Actualmente, tienen tres opciones disponibles, y cada una tiene características distintas en términos de coste, nivel de competencia y beneficios potenciales:
Para acceder a cada una se debe pagar una cuota de inscripción 

**Competición en Barcelona:** La cuota de inscripción es de 2,000 euros y el coste de transporte es bajo ya que no saldrían de España, aproximadamente de unos 1,000 euros. El equipo espera obtener buenos resultados aquí ya que se encuentran en casa, en caso de ganar, podrían conseguir un premio de 5,000 euros. Sin embargo, el nivel de competencia es medio bajo teniendo muchas posibilidades de quedar entre los primeros.

**Competición en Hockenheim (Alemania):** Es una de la competición más prestigiosa, esto se ve reflejado en su cuota de inscripción que es de 3,500 euros. Además el coste de transporte debido a las escasas conexiones es elevado llegando a 4,000 euros. Si logran quedar entre los primeros puestos, podrían conseguir un premio de 10,000 euros.Una increible recompensa que sumada al orgullo de ganarla es un gran aliciente. 

**Competición en Assen (Paises Bajos):** El coste de inscripción es intermedio, 2,800 euros, y el coste de transporte es de 3,500 euros. Es una competición con buen reconocimiento pero que no lleva tantos años celebrandose. El premio es una buena cifra tratándose de 7,000 euros, y el nivel de competencia también es alto.

¿A qué competición le recomendarías a la directiva del equipo asistir?

Costes y premios:
  o	Competición en España:
  
    -	Coste total: 2,000 € (inscripción) + 1,000 € (transporte) = 3,000 €
    -	Premio si gana: 5,000 €
    -	Beneficio neto si gana: 5,000 - 3,000 = 2,000 €
    -	Beneficio neto si no gana: -3,000 € (pérdida de costes)
    
  o Competición en Alemania:

    - Coste total: 3,500 € (inscripción) + 4,000 € (transporte) = 7,500 €
    - Premio si gana: 10,000 €
    - Beneficio neto si gana: 10,000 - 7,500 = 2,500 €
    - Beneficio neto si no gana: -7,500 € (pérdida de costes)
    
    
  o Competición en Países Bajos:
  
    - Coste total: 2,800 € (inscripción) + 3,500 € (transporte) = 6,300 €
    - Premio si gana: 7,000 €
    - Beneficio neto si gana: 7,000 - 6,300 = 700 €
    - Beneficio neto si no gana: -6,300 € (pérdida de costes)


\newpage
```{r}
tb02= crea.tablaX(c(2000,-3000,
                    2500,-7500,
                    700,-6300),numalternativas = 3,numestados = 2)
rownames(tb02)=c("España","Alemania","Paises Bajos")
colnames(tb02)=c("Ganar","Perder")
knitr::kable(tb02)
```
```{r}
solp2=criterio.Todos(tb02,alfa = 0.3,favorable = FALSE)
knitr::kable(solp2[,3:ncol(solp2)])

```



\newpage

# Roberto González Lozano

## Problema 1

## Problema 2

\newpage

# Belén Puertas Gonzalez

## Problema 1

## Problema 2

\newpage

# María del Rosario Ruiz Avila

## Problema 1
Aplicar los criterios de decisión bajo incertidumbre a los problemas cuya matriz de valores numéricos viene dada en la tabla siguiente:
Creamos la matriz de decisión:
```{r}
tabla_decision <- matrix(c(7, 5, 8,   # Publicidad TV
                           4, 6, 3,   # Publicidad Online
                           2, 9, 7,   # Eventos Presenciales
                           5, 4, 6),  # Influencers
                         nrow = 4, byrow = TRUE)

rownames(tabla_decision) <- c("Publicidad TV", "Publicidad Online", "Eventos Presenciales", "Influencers")
colnames(tabla_decision) <- c("Mercado Local", "Mercado Internacional", "Nuevas Tecnologías")
tabla_decision
```
Donde las estrategias son los tipos de publicidad y los estados de la naturaleza los mercados considerar:
a)Beneficios (favorable)
Criterio de wald: Selecciona la estrategia que tenga el mayor de los valores mínimos, siendo conservador.
```{r}
s01_wald = criterio.Wald(tabla_decision,T)
s01_wald
names(s01_wald$AlternativaOptima)
```
Criterio Optimista: Este criterio selecciona la estrategia con el mejor resultado posible, siendo muy optimista.
```{r}
s01_optima=criterio.Optimista(tabla_decision,T)
s01_optima
names(s01_optima$AlternativaOptima)
```
Criterio  Hurwicz:ombina el optimismo y el pesimismo mediante un coeficiente alfa (en este caso, 0.4, lo que significa que se considera más pesimismo).
```{r}
s01_hurwitz=criterio.Hurwicz(tabla_decision,alfa=0.4,T)
s01_hurwitz
names(s01_hurwitz$AlternativaOptima)
```
Criterio Savage: Minimiza el arrepentimiento, es decir, la diferencia entre lo que se obtuvo y lo que podría haberse obtenido en el mejor escenario.
```{r}
s01_savage=criterio.Savage(tabla_decision,T)
s01_savage
names(s01_savage$AlternativaOptima)
```
Criterio Laplace:Considera que todos los estados de la naturaleza son igualmente probables.
```{r}
s01_laplace=criterio.Laplace(tabla_decision,T)
names(s01_laplace$AlternativaOptima)
s01_laplace$ValorAlternativas
```
Criterio Punto Ideal: Compara las alternativas con un "punto ideal" en el que se maximiza todo.
```{r}
s01_pid=criterio.PuntoIdeal(tabla_decision,T)
s01_pid$AlternativaOptima
s01_pid$ValorAlternativas
```
Todos los criterios:
```{r}
s01_todos=criterio.Todos(tabla_decision,alfa=0.5,T)
s01_todos
dibuja.criterio.Hurwicz(tabla_decision,T)
dibuja.criterio.Hurwicz_Intervalos(tabla_decision,T)
```
En todos los casos la mejor estrategia es la Publicidad en TV, excepto en el criterio optimista que la estrategia son los Eventos Presenciales. 

b)Costos (desfavorable)
Criterio de wald
```{r}
s01_wald = criterio.Wald(tabla_decision,F)
names(s01_wald$AlternativaOptima)
```
Criterio Optimista
```{r}
s01_optima=criterio.Optimista(tabla_decision,F)
names(s01_optima$AlternativaOptima)
```
Criterio  Hurwicz
```{r}
s01_hurwicz=criterio.Hurwicz(tabla_decision,alfa=0.4,F)
names(s01_hurwitz$AlternativaOptima)
```
Criterio Savage
```{r}
s01_savage=criterio.Savage(tabla_decision,F)
names(s01_savage$AlternativaOptima)
```
Criterio Laplace
```{r}
s01_laplace=criterio.Laplace(tabla_decision,F)
names(s01_laplace$AlternativaOptima)
s01_laplace$ValorAlternativas
```
Criterio Punto Ideal
```{r}
s01_pid=criterio.PuntoIdeal(tabla_decision,F)
s01_pid$AlternativaOptima
s01_pid$ValorAlternativas
```
Todos los criterios:
```{r}
s01_todos=criterio.Todos(tabla_decision,alfa=0.5,F)
s01_todos
dibuja.criterio.Hurwicz(tabla_decision,F)
dibuja.criterio.Hurwicz_Intervalos(tabla_decision,F)
```
En 5 de los criterios la mejor opción es la Publicidad Online para minimizar los costos. El criterio de Wald tiene dos soluciones, la anterior y la estrategia de Influencers. Por otro lado, el criterio optimista repite con Eventos Presenciales. 

## Problema 2
Dos amigos, Claudia y Mario, están planeando abrir una pequeña cafetería. Han ahorrado 1500 euros cada uno y quieren decidir qué enfoque darle al negocio. Existen tres opciones según el tipo de menú que ofrezcan: Un menú básico, un menú saludable o un menú gourmet. Dependiendo de la situación económica y las tendencias alimentarias, la demanda puede aumentar o disminuir, lo que afectará sus ingresos.

Si eligen un menú básico, tendrán un flujo constante de clientes, pero los márgenes de ganancia serán bajos, con una ganancia o pérdida del 5%.

Si eligen un menú saludable, pueden atraer a un nicho de clientes en crecimiento, pero la inversión en ingredientes será mayor, y podrían obtener una ganancia del 12% si la tendencia continúa, o perder un 8% si la tendencia no se mantiene.

Si optan por un menú gourmet, el riesgo es mayor porque depende de la clientela de alto poder adquisitivo, lo que les permitirá obtener una ganancia del 20% si la economía es favorable, pero podrían perder un 15% si la economía se desacelera.
Claudia es más conservadora y prefiere minimizar los riesgos, mientras que Mario está dispuesto a asumir más riesgos confiando en que la economía mejorará.

¿Qué tipo de menú elegiría cada uno de ellos según sus actitudes hacia el riesgo?
Estado e1 (Demanda favorable)
```{r}
n11 = 1500 * 0.05     # Menú básico
n21 = 1500 * 0.12     # Menú saludable
n31 = 1500 * 0.20     # Menú gourmet
```
Estado e2 (Demanda desfavorable)
```{r}
n12 = -1500 * 0.05    # Menú básico
n22 = -1500 * 0.08    # Menú saludable
n32 = -1500 * 0.15    # Menú gourmet
```
Crear la tabla de decisión
```{r}
tb_decision = crea.tablaX(c(n11, n12,
                            n21, n22,
                            n31, n32), 3, 2)
```
Aplicar los criterios de decisión
```{r}
res_decision = criterio.Todos(tb_decision, alfa = 0.5, favorable = TRUE)
```
Mostrar los resultados en formato tabla
```{r}
knitr::kable(res_decision)
```
Claudia es conservadora y busca minimizar las posibles pérdidas. Aplicando el criterio de Wald o Minimax, probablemente seleccione la opción del menú básico, que ofrece la menor pérdida en el peor escenario (-75 euros). 
Mario es más arriesgado y busca maximizar sus posibles ganancias. Aplicando el criterio optimista (Maximax), seleccionará el menú gourmet, que le podría dar la mayor ganancia en el mejor escenario (300 euros).
Claudia optará por un menú básico y Mario por un menú gourmet. 

